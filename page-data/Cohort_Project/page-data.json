{"componentChunkName":"component---src-templates-post-tsx","path":"/Cohort_Project/","result":{"data":{"markdownRemark":{"html":"<table>\n<thead>\n<tr>\n<th align=\"center\">프로젝트</th>\n<th align=\"left\">Cohort, Retention, RFM 을 통해 Retail 데이터 분석</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">분석 목표</td>\n<td align=\"left\">퍼널 분석을 통해 유입된 고객이 있다고 가정을 하고,Cohort 분석을 통해 우리가 데려온 고객들을 얼마나<br>잘 자키고 있는지 retention을 측정을 하고, 고객별로 적절한 마케팅 메세지를 보내주기 위해 RFM을 하여<br>고객들을 세그먼트한다.</td>\n</tr>\n<tr>\n<td align=\"center\">분석 환경</td>\n<td align=\"left\">Google SQL(추출), EXCEL(시각화)</td>\n</tr>\n<tr>\n<td align=\"center\">담당 업무</td>\n<td align=\"left\">1. EDA 탐색점 데이터 분석<br>2.프로젝트 기획<br>3.퍼널 분석 후 시각화<br>4.Retention 계산<br> 5.RFM 계산 후 시각화</td>\n</tr>\n<tr>\n<td align=\"center\">데이터</td>\n<td align=\"left\"><a href=\"https://www.kaggle.com/jihyeseo/online-retail-data-set-from-uci-ml-repo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.kaggle.com/jihyeseo/online-retail-data-set-from-uci-ml-repo</a></td>\n</tr>\n</tbody>\n</table>\n<br>\n<h1 id=\"코호트-분석-br\" style=\"position:relative;\"><a href=\"#%EC%BD%94%ED%98%B8%ED%8A%B8-%EB%B6%84%EC%84%9D-br\" aria-label=\"코호트 분석 br permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>코호트 분석 <br></h1>\n<h3 id=\"step-1-코호트의-기간-기준-정하기\" style=\"position:relative;\"><a href=\"#step-1-%EC%BD%94%ED%98%B8%ED%8A%B8%EC%9D%98-%EA%B8%B0%EA%B0%84-%EA%B8%B0%EC%A4%80-%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\"step 1 코호트의 기간 기준 정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 1. 코호트의 기간 기준 정하기</h3>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">DISTINCT</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> invoice_date\n<span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">`</span>axial<span class=\"token operator\">-</span>coyote<span class=\"token operator\">-</span><span class=\"token number\">310511.</span>cohort<span class=\"token punctuation\">.</span>cohort_project<span class=\"token punctuation\">`</span>\n<span class=\"token keyword\">ORDER</span> <span class=\"token keyword\">BY</span> invoice_date\n<span class=\"token keyword\">LIMIT</span> <span class=\"token number\">300</span></code></pre></div>\n<p align=\"left\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 117px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/45d0006645765eab015f97c07969b970/32586/2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 170.0854700854701%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAiCAYAAABfqvm9AAAACXBIWXMAABYlAAAWJQFJUiTwAAAE8UlEQVRIx5WWW09jVRTH+zX8Jn4SM08+mKgPXl68zYOZGBMz+KJGk5lECTEio4a7CJQCQ2EAA+U69H6BlpbeoPROe0rbv+u/z+wzu2Q08SQn55x9Xev/W2vt42q32+h0Ori5uQHfefV6PXWzrV6vo9lswrIsNBoN1c5xtVoNt7e3qq9SqThzXRxwfn6O5eVlrKysqMZut6ue8XgcMzMzWFtbw9bWFubn5xGJRHBwcIDt7W0Eg0Hs7++rufFY3F5QW5dOp3F6ejqwYDKZVJNjsRjy+TyODg9RLORRurzE8+NjXGQyCMmihzKG/WpBLmZe/X5fuUV3/tdFmWSOq1qtKg15U6dWq6VubsRvdYs+3Na6OEdrdxPW4S6ssB/taBBWNq3mUsEWLdSLcGEKrKHQUi5aq5RR7/WBlVk0Hn2Nnm8TrcAxavEIbtNJNP7eQGXsR3SG7gObHrjo2tnZGSYmJrCxseEQVlCiUUx5VnDw/RBOP3sXf3qfIZQ6x74/gG2fD37p5/vSX3MILM0Dn7wJFwEQyLGInEicOhbyIv3nR0do3n8b+UQMJ6EwSsUiytfX8J+cIJ/LIRwKIuj3Iy9OYPZXuLSbL7W1gXRECo5BLoP+Vx9rZA4484muDbC3MAGXDlDe1JMBakNpoiODbkX03oP30ZG53KQtfWpDgniRFBaTQsZ25sdtKBT/WtzgQnpn3g1pL4uL1qdvoVnIoX7TUlYSIA3hxUzigtwcv/9ka8jAXV1dhV+04KVjMBoOY8LtQfa9e9h/8jN8J35EQiG4FxfhleyJCZRVyZLRkRH4ogng4Uf2ghSfYLizCSWdSsKfySH/zReoPBpCSdrK9QYiyRSK1RqqrTZiWQFTqqAw/RvwwRuvhsJNqI1z1cW9D+8BaxIaEtzIpGS3MwkDiYqjHeDzd4DXX0PXPWVD4WRTaJ0pKoOstg2HC/3wJfrfPgAePwRGvkN/8hf0hSzGHsNKRF5mCq0sivgsQyYUCl4qlVARYDVxr/oicMptC2WrAwpDNMWOlLqeHUJKQ5Ypj8eD3d3dgWpDWFNTU6rPt7ODPblDgQAWpYx5nz5VgDzuRfzxZEwlgFqQrmazWQRkYCqVGoCSkfIUFtIERmnoAa1OJBLKchZcpi3LXqFQsBdko+mmGeROJhhV3MwSs1+Hm5MpdJNPQtFgzHZzI92u380sUxWbVuYk0cvl8kCOcjO6QvcYo+ynlVdXV6qN78ww9mndFZSoRLzb7cb6+voAFJ4fLGsKipSrvb09hATEwsICvF6vmre0tITh4WHV7kChdRSacEwobGcEXFxcKBi0hN7wrKG1fGeWMRoYdmrBu5miNRvIFAPCf0HhXAeKPlc0FJ0pd6GwT0PR72afgkJXKLIuSXpnttPtSzk2Kb4GwW+6yEXZRqn4dKBQv9nZWUxPTw+WLxF9cnLSgcJDnYc7oRAgg35RShlLH3UdgMIs0dFuQmEW8BCn1gTD+NSlju/MJg3kXzNFn9EmCHqib/Nb/xjoiuXiruYgfbhzd37rlNPvnKjbNDRtCOcpKIRBl/X/iXaZsUb32M7sIAwtEdv4Tnc5l4YNZMrc3Jz6izIzhaKPj48rKMwSDYV/YYTCTCKU0dFRHMqPlAOFuxC9hqLDhu20kJZRAoLhk2NpEeOOlrJfJ4gD5W6mUI+7Z40GYP6lmZnEef8Agi311zUmJiwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"2\" title=\"2\" src=\"/static/45d0006645765eab015f97c07969b970/32586/2.png\" srcset=\"/static/45d0006645765eab015f97c07969b970/32586/2.png 117w\" sizes=\"(max-width: 117px) 100vw, 117px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></p> \n&#xC6B0;&#xC120; &#xCF54;&#xD638;&#xD2B8; &#xAE30;&#xAC04;&#xC744; &#xD55C; &#xB2EC;&#xB85C; &#xC7A1;&#xC558;&#xB2E4;. &#xC774;&#xC720;&#xB294; Retail &#xC0B0;&#xC5C5;&#xC744; &#xACE0;&#xB824;&#xD558;&#xBA74; &#xCF54;&#xD638;&#xD2B8; &#xAE30;&#xAC04;&#xC744; daily&#xB85C; &#xC7A1;&#xB294; &#xAC83;&#xC774; &#xB9DE;&#xACA0;&#xC9C0;&#xB9CC;, &#xB370;&#xC774;&#xD130;&#xB97C; &#xC0B4;&#xD3B4;&#xBCF4;&#xB2C8; daily &#xB85C;&#xADF8;&#xAC00; &#xB9CE;&#xC774; &#xBE60;&#xC838;&#xC788;&#xC5C8;&#xAE30; &#xB54C;&#xBB38;&#xC774;&#xB2E4;.\n<h3 id=\"step2-코호트-index-구하기\" style=\"position:relative;\"><a href=\"#step2-%EC%BD%94%ED%98%B8%ED%8A%B8-index-%EA%B5%AC%ED%95%98%EA%B8%B0\" aria-label=\"step2 코호트 index 구하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step2. 코호트 index 구하기.</h3>\n<ol>\n<li>처음 구매한  시점부터 고객들을 월별로 나눠서  트랙킹 하기.</li>\n<li>\n<p>고객별로 고객이 가장 처음에 구매한 일자 구하기.</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> customer_id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token function\">MIN</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cohort_day\n<span class=\"token keyword\">FROM</span> cohort<span class=\"token punctuation\">.</span>cohort_project\n<span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> customer_id</code></pre></div>\n</li>\n<li>원본 데이터에 고객별로 처음 구매한 날자 테이블을 JOIN해주기</li>\n<li>우리가 궁극적으로 구해야 하는 것은 코호트 Index.\n코호트 Index란, 고객이 첫 구매하고 재구매가 일어났는지알 알기 위해서 재구매 날과 첫 구매 날의 차를 계산한 결과.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">WITH</span> first_purchase <span class=\"token keyword\">AS</span> <span class=\"token punctuation\">(</span>\n<span class=\"token keyword\">SELECT</span> customer_id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token function\">MIN</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cohort_day\n<span class=\"token keyword\">FROM</span> cohort<span class=\"token punctuation\">.</span>cohort_project\n<span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> customer_id\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> c<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">.</span>cohort_day<span class=\"token punctuation\">,</span> DATE_DIFF<span class=\"token punctuation\">(</span><span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> cohort_day<span class=\"token punctuation\">,</span> <span class=\"token keyword\">MONTH</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cohort_index\n<span class=\"token keyword\">FROM</span> cohort<span class=\"token punctuation\">.</span>cohort_project c <span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> first_purchase f\n<span class=\"token keyword\">ON</span> c<span class=\"token punctuation\">.</span>customer_id <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>customer_id</code></pre></div>\n<h3 id=\"step3-코호트-그룹-만들기\" style=\"position:relative;\"><a href=\"#step3-%EC%BD%94%ED%98%B8%ED%8A%B8-%EA%B7%B8%EB%A3%B9-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\"step3 코호트 그룹 만들기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step3. 코호트 그룹 만들기.</h3>\n<p>같은 달에 첫 구매한 애들끼리 그룹으로 묶어주기.</p>\n<ol>\n<li>코호트 기간을 월로 정했으나 cohort<em>day를 보면 일까지 나와있다. 코호트로 그룹을 만들기 위해서 월로 바꿔줘야 한다. 함수 DATE</em>TRUNC()이용.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">WITH</span> first_purchase <span class=\"token keyword\">AS</span> <span class=\"token punctuation\">(</span>\n<span class=\"token keyword\">SELECT</span> customer_id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token function\">MIN</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cohort_day\n<span class=\"token keyword\">FROM</span> cohort<span class=\"token punctuation\">.</span>cohort_project\n<span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> customer_id\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span> c<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">.</span>cohort_day<span class=\"token punctuation\">,</span> DATE_DIFF<span class=\"token punctuation\">(</span><span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> cohort_day<span class=\"token punctuation\">,</span> <span class=\"token keyword\">MONTH</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cohort_index<span class=\"token punctuation\">,</span> DATE_TRUNC<span class=\"token punctuation\">(</span>cohort_day<span class=\"token punctuation\">,</span> <span class=\"token keyword\">MONTH</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cohort_group\n<span class=\"token keyword\">FROM</span> cohort<span class=\"token punctuation\">.</span>cohort_project c <span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> first_purchase f\n<span class=\"token keyword\">ON</span> c<span class=\"token punctuation\">.</span>customer_id <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>customer_id\n </code></pre></div>\n<br>\n<p align=\"left\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 508px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/2617346dd7bb371ef6e3b9e2ff71d4b8/2fd48/3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 104.05405405405406%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC/0lEQVQ4y3VU2Y7aQBD0//9EXvMTkaKVlmsxWQO2FzDnchpzs+C70jUwKwcRS62x7O6e6qqaMc7nMz4/P+H7Pvxgg0WwxWIdIIoipFmGNE2/I45jHA4HXK9XTCYTbDYb+Os1Zv4a/v6AMM1gHI9HOLaNlTQZmjW4P39g8vobGYBcGuZ5juy+suFyucTX1xfsdhuBNPQcG+7rC6ZmBeFqDoNIuCPXJAyRHA+I9lvESYJUIikEUTJP1VwukpMi2QZI2ibi0i9ErgVjt9uhUqlgOBrBsd7xXn5F23xTRY8PUW63W3CqUqmE6XSKlu2g4XygO1uAFQZ3VsmM2Rh5/QV5s6bGSx4QapS6JpOi/HxE7jnI23VE6yUMktxoNDAej+H1+3A7XXR6PdXwGUIKcTqdUK/XMZ/P0el0hM8WBp6HKIxgkD+OfRFO2JzvXNmwqHBR6VC4Zh5r9/s9dhJnESqSfwYbkQvuvBYLBEEgFlopDqluMTiqbsQavrOGyrOONTfbOA5WqxWGwyGGg4Eanyj0mAw+REi/0jZtsQ1BDCSfY89mU2koCDkCg91pg1iQRPdvz0RReff/3PT2nVTc/inb1Gpi6A+RXkxqv1VhiUjPROHYHJVTlctlNVlfxHBElI7r3BAqQ9MO4oFMDJ2KBZLTEcndHs9so9BTNJ6i6wVZ30Xu/EHsP9iGlrG7Pdiy8yOH+ghSANrGNE3hbaa4bDUtDHpdhCKwsg2bhoKUF8VJxlG2ETSPKhMd87kZ7UKkJ9ZIXOUbaww26YuhF4uF2nEkR5A8MTkr3DZ85zfag1bzhDs6g7l0B03OjQzCp/Q8o/zIhkx8RKebM4+2YQ0nYUPW0E5KZX1SiJSJXKniM4QUheiIRDdmvg51UsgFzyUv2Q+xTqvVUkRr2xSNzYYUj1PRaqTJlru02WwqxArh982RZf947n/G1kgfa7ip8iERVqtVxYPrumo3onxm7CJCGlvbxrIseHJDqYbkkJxxZaIObfhicBPyRg5Zw5W5fFfcSs1fd8I/PYOq/AwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"3\" title=\"3\" src=\"/static/2617346dd7bb371ef6e3b9e2ff71d4b8/2fd48/3.png\" srcset=\"/static/2617346dd7bb371ef6e3b9e2ff71d4b8/12f09/3.png 148w,\n/static/2617346dd7bb371ef6e3b9e2ff71d4b8/e4a3f/3.png 295w,\n/static/2617346dd7bb371ef6e3b9e2ff71d4b8/2fd48/3.png 508w\" sizes=\"(max-width: 508px) 100vw, 508px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></p> \n4&#xC6D4; 7&#xC77C;&#xC744; 4&#xC6D4; 1&#xC77C;&#xB85C; 3&#xC6D4; 23&#xC77C;&#xC740; 3&#xC6D4;1&#xB85C; &#xBC14;&#xB010;&#xAC83;&#xC744; &#xBCFC; &#xC218; &#xC788;&#xB2E4;. \n<ol start=\"2\">\n<li>코호트 그룹별로, 코호트 인덱스별로 해당하는 고객수가 얼마나 되는지 확인하기. </li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">WITH</span> first_purchase <span class=\"token keyword\">AS</span> <span class=\"token punctuation\">(</span>\n<span class=\"token keyword\">SELECT</span> customer_id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token function\">MIN</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cohort_day\n<span class=\"token keyword\">FROM</span> cohort<span class=\"token punctuation\">.</span>cohort_project\n<span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> customer_id\n<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">SELECT</span>  cohort_group<span class=\"token punctuation\">,</span> cohort_index<span class=\"token punctuation\">,</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">DISTINCT</span> customer_id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> customer_count\n<span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">(</span>\n   <span class=\"token keyword\">SELECT</span> c<span class=\"token punctuation\">.</span><span class=\"token operator\">*</span><span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">.</span>cohort_day<span class=\"token punctuation\">,</span> DATE_DIFF<span class=\"token punctuation\">(</span><span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> cohort_day<span class=\"token punctuation\">,</span> <span class=\"token keyword\">MONTH</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cohort_index<span class=\"token punctuation\">,</span> DATE_TRUNC<span class=\"token punctuation\">(</span>cohort_day<span class=\"token punctuation\">,</span> <span class=\"token keyword\">MONTH</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> cohort_group\n   <span class=\"token keyword\">FROM</span> cohort<span class=\"token punctuation\">.</span>cohort_project c <span class=\"token keyword\">LEFT</span> <span class=\"token keyword\">JOIN</span> first_purchase f\n   <span class=\"token keyword\">ON</span> c<span class=\"token punctuation\">.</span>customer_id <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span>customer_id<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> cohort_group<span class=\"token punctuation\">,</span> cohort_index</code></pre></div>\n<p>우리가 retention을 볼 때 다음 달에 한번 구매하던 두 번 구매하던 상관없이 이달에 첫 구매한 100명 중에 몇 명이 시간이 지나도 살아있나를 보기 위해서 customer_id를 셀 때 한 사람이 여러분 구매할 수 있으니 DISTINCT을 써줘야 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/74b69dc86d243f45ac1b84bacb7d0ae5/536c7/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.45945945945946%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABWklEQVQoz4XRS0/CQBQFYP7/1rgBdSOiKKBYEEVACRgWKDFKEdG+ppYYGgpCaYUWjneKGgkLJzm5mWby5cw01Ol0YBgGfN/HbDZDv9+HrjM8K12I5TrapwWIQhFi6hzNwwyayVywb1Eej7Joxk7QCEfxelGB3mgjpCgKbNvGYrEIQL4+hkOohLJaDW/JFNheDCwcAdveAduNQqeokS2wjU0Y+wcw67eYmibgThCSZRmj0egXnM/nsKilrKrQ7h/A8kVo+QK0yxL06wqYkIMST4CVyjBVBsfz4VOJIGSsgXxalgVZ08DuGjCq1PKqTFAWaiwORTjD+4sEx/1cIp4HbzqFR5M/W0iSpDVwOBgsGxLI0gLUxDG03AV6YguOPVlCPkF0nkM/CUDecEDASkN+ZWqoVG+gpTPoPbXhOO435K9BKyD/KfyK/O34Rz7H4zFUArsUd+L8C/0FvwAm5QJB2VRmQQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/74b69dc86d243f45ac1b84bacb7d0ae5/fcda8/4.png\"\n        srcset=\"/static/74b69dc86d243f45ac1b84bacb7d0ae5/12f09/4.png 148w,\n/static/74b69dc86d243f45ac1b84bacb7d0ae5/e4a3f/4.png 295w,\n/static/74b69dc86d243f45ac1b84bacb7d0ae5/fcda8/4.png 590w,\n/static/74b69dc86d243f45ac1b84bacb7d0ae5/efc66/4.png 885w,\n/static/74b69dc86d243f45ac1b84bacb7d0ae5/c83ae/4.png 1180w,\n/static/74b69dc86d243f45ac1b84bacb7d0ae5/536c7/4.png 1480w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>표를 가로로 보면 유저의 라이프 사이클을 볼 수 있고 세로로 보면 프로덕트의 라이프 사이클을 볼 수 있다.\n가로로 보면 2010년 12월 1일에 가입한 사람들은 885명인데 1달이 지났을 때 재구매 비율이 37%, 그다음 달부터는 안정적으로 유지가 되는 것을 볼 수 있다.\n두 번째 그룹을 보더라도 처음에 22%로 떨어지더라도 그다음부터는 매우 안정적으로 재구매가 일어난다.</p>\n<p>값을 세로로 본다면 (가장 최근 데이터는 염두 해주지 말자. 가장 최근 데이터가 2011년 12월 중순이기 때문에 12달 데이터가 완벽히 수집이 안된 상태다.) 데이터가 크게 안 좋아지지는 않는다.</p>\n<p>유저의 리텐션은 2달 후부터는 매우 안정적이고, 그리고 프로덕트 라이프 사이클을 봐도 건강한 편이다.\n특이한 점은 2010년 12월에 데려온 고객들이 높은 retention을 보여주는 것. 첫 코호트 고객들에게 회사가 특별한 이벤트를 진행했을 가능성이 있다고 본다. <BR>\n엑셀 파일: <a href=\"/24f3aaf8db04dea20be1b665f4ee4d69/sql_cohort_result.csv\" download>sql<em>cohort</em>csv</a></p>\n<h1 id=\"리텐션\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%ED%85%90%EC%85%98\" aria-label=\"리텐션 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리텐션</h1>\n<p>코호트 분석과 클레식 리텐션, 레인지 리텐션을 구하는 방법이 같기 때문에 롤링 리텐션으로 데이터를 분석해보려고 한다. </p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span>customer_id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> total_customer\n   <span class=\"token punctuation\">,</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span>  diff_day <span class=\"token operator\">>=</span><span class=\"token number\">29</span> <span class=\"token keyword\">THEN</span> <span class=\"token number\">1</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> retention_customer\n   <span class=\"token punctuation\">,</span> <span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">CASE</span> <span class=\"token keyword\">WHEN</span>  diff_day <span class=\"token operator\">>=</span><span class=\"token number\">29</span> <span class=\"token keyword\">THEN</span> <span class=\"token number\">1</span> <span class=\"token keyword\">END</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span>customer_id<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> rolling_retention_30\n<span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">(</span>\n<span class=\"token keyword\">SELECT</span> customer_id<span class=\"token punctuation\">,</span> <span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token function\">MIN</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> first_purchase<span class=\"token punctuation\">,</span>\n   <span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> recent_purchse<span class=\"token punctuation\">,</span>\n   DATE_DIFF<span class=\"token punctuation\">(</span><span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token function\">MIN</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DAY</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> diff_day\n<span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">`</span>axial<span class=\"token operator\">-</span>coyote<span class=\"token operator\">-</span><span class=\"token number\">310511.</span>cohort<span class=\"token punctuation\">.</span>cohort_project<span class=\"token punctuation\">`</span>\n<span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> customer_id<span class=\"token punctuation\">)</span></code></pre></div>\n<p align=\"left\"><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/7941e09cae45e8d350ecb1baa66a6dcb/2e237/5.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 18.243243243243242%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAqklEQVQY011P2aqFMBDr//+gD9aibZG6tW6oqJBzM9zC4QyESZvJLGqeZ4zjKIjTBOsDjJuwLAu6rsMwDEgpoe974du2Cc9aziEE7PsOFWOEMQZVVf1D/zVLUlAUBbTWaJoGZVmirmsZ5JwTD//psdaibVvc9w31vi++g0XOefzGcRxi5EU056bee/FQ41D1PA8INmbmBlw9v7N2XRfWdcV5nnI2OWszz/kDocot8INgDXAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"5\" title=\"5\" src=\"/static/7941e09cae45e8d350ecb1baa66a6dcb/fcda8/5.png\" srcset=\"/static/7941e09cae45e8d350ecb1baa66a6dcb/12f09/5.png 148w,\n/static/7941e09cae45e8d350ecb1baa66a6dcb/e4a3f/5.png 295w,\n/static/7941e09cae45e8d350ecb1baa66a6dcb/fcda8/5.png 590w,\n/static/7941e09cae45e8d350ecb1baa66a6dcb/2e237/5.png 790w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span></p> \n&#xACB0;&#xACFC;: &#xB370;&#xC774;&#xD130;&#xC0C1; 30&#xC77C;&#xC774; &#xC9C0;&#xB098;&#xB3C4; &#xC5EC;&#xC804;&#xD788; &#xC0B4;&#xC544;&#xC788;&#xB294; &#xACE0;&#xAC1D;&#xC740; 60%&#xC815;&#xB3C4;&#xC774;&#xB2E4;.\n<h1 id=\"rfm\" style=\"position:relative;\"><a href=\"#rfm\" aria-label=\"rfm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>RFM</h1>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language-sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> customer_id<span class=\"token punctuation\">,</span>\n<span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> recent_purchase<span class=\"token punctuation\">,</span>\nDATE_DIFF<span class=\"token punctuation\">(</span><span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2011-12-10'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DATE</span><span class=\"token punctuation\">(</span><span class=\"token function\">MAX</span><span class=\"token punctuation\">(</span>invoice_date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">DAY</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> recency<span class=\"token punctuation\">,</span>\n<span class=\"token function\">COUNT</span><span class=\"token punctuation\">(</span>invoice_no<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> frequency<span class=\"token punctuation\">,</span>\n<span class=\"token function\">SUM</span><span class=\"token punctuation\">(</span>quantity <span class=\"token operator\">*</span> unit_price<span class=\"token punctuation\">)</span> <span class=\"token keyword\">AS</span> monetary\n \n<span class=\"token keyword\">FROM</span> <span class=\"token punctuation\">`</span>axial<span class=\"token operator\">-</span>coyote<span class=\"token operator\">-</span><span class=\"token number\">310511.</span>cohort<span class=\"token punctuation\">.</span>cohort_project<span class=\"token punctuation\">`</span>\n<span class=\"token keyword\">GROUP</span> <span class=\"token keyword\">BY</span> customer_id</code></pre></div>\n<p><a href=\"/e2b6eb5acf50535d54085db7508ca347/RFM.csv\" download>RFM<em>분석</em>결과_csv</a></p>","excerpt":"프로젝트 Cohort, Retention, RFM 을 통해 Retail 데이터 분석 분석 목표 퍼널 분석을 통해 유입된 고객이 있다고 가정을 하고,Cohort 분석을 통해 우리가 데려온 고객들을 얼마나잘 자키고 있는지 retention을 측정을 하고…","tableOfContents":"<ul>\n<li>\n<p><a href=\"/Cohort_Project/#%EC%BD%94%ED%98%B8%ED%8A%B8-%EB%B6%84%EC%84%9D-br\">코호트 분석 <br></a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"/Cohort_Project/#step-1-%EC%BD%94%ED%98%B8%ED%8A%B8%EC%9D%98-%EA%B8%B0%EA%B0%84-%EA%B8%B0%EC%A4%80-%EC%A0%95%ED%95%98%EA%B8%B0\">Step 1. 코호트의 기간 기준 정하기</a></li>\n<li><a href=\"/Cohort_Project/#step2-%EC%BD%94%ED%98%B8%ED%8A%B8-index-%EA%B5%AC%ED%95%98%EA%B8%B0\">Step2. 코호트 index 구하기.</a></li>\n<li><a href=\"/Cohort_Project/#step3-%EC%BD%94%ED%98%B8%ED%8A%B8-%EA%B7%B8%EB%A3%B9-%EB%A7%8C%EB%93%A4%EA%B8%B0\">Step3. 코호트 그룹 만들기.</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/Cohort_Project/#%EB%A6%AC%ED%85%90%EC%85%98\">리텐션</a></li>\n<li><a href=\"/Cohort_Project/#rfm\">RFM</a></li>\n</ul>","fields":{"slug":"/Cohort_Project/"},"frontmatter":{"title":"코호트, 리텐션, RFM을 이용한 데이터 분석 프로젝트","date":"Apr 13, 2021","tags":["코호트분석","리텐션분석","RFM분석","데이터분석가","데이터분석프로젝트","SQL","Ggoogle SQL Query"],"keywords":["0x530x650x610x6E","Sean Seung Kyu Kim"],"update":"Jan 01, 0001"}}},"pageContext":{"slug":"/Cohort_Project/","series":[],"lastmod":"2021-04-13"}},"staticQueryHashes":["2027115977","694178885"]}